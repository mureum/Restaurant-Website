<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="waiterCall.css">
    <title>Waiter Call</title>
</head>
<body>
  <form >
    <div class="div1">
      <div class="mb-3">
    <label class="form-label">Table Number *</label>
    <input type="number" class="form-control" id="table" placeholder="Enter your table number" required >
  </div>
  <div class="mb-3">
    <label class="form-label">Problem Description</label>
    <input type="text" class="form-control" id="problem" placeholder="Describe your issue if possible">
  </div >
  <div class="btn1">

    <button onclick="callWaiter()" type="submit" id = "call" class="btn btn-secondary">Call for Waiter</button>
  </div>
  
      </div>
  </form>  
<script src="waiterCall.js">
//Connecting to the database
const { Pool } = require('pg');
const pool = new Pool({
    user: 'boladale',
    host: 'db.bit.io',
    database: 'alelentini2001/oaxaca', 
    password: 'v2_3z5Rc_3Y3niQU6FKgG7DwzMQZYzsq',
    port: 5432,
    ssl: true,
});


var data ;
function callWaiter() {
    const tableNumber = document.getElementById("table").value;
    const problemDescription = document.getElementById("problem").value;
  
    if ((tableNumber === "") || (problemDescription === "")){
      window.alert("Please enter your table number and Problem Description!");
    } else {
      window.alert("Your request has been sent.");   
      waiterCallInfo(tableNumber, problemDescription);
    }   
  }
function waiterCallInfo(tableNumber, problemDescription) {
    let myquery = `INSERT INTO waiter_calls VALUES (${tableNumber}, '${problemDescription}');`;
  
    pool.query(myquery,[tableNumber, problemDescription], (err, res) => {
      console.table(res.rows);
    });
  }
  
  let table = "waiter_calls";
  let myquery2 = `SELECT * FROM ${table};`;
  
  pool.query(myquery2, (err, res) => {
    console.table(res.rows);
  });

  console.log(document.getElementById("problem").value);

</script>
</body>
</html>